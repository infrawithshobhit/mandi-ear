<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hindi Language Dropdown Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .test-container { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-result { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        iframe { width: 100%; height: 600px; border: 1px solid #ddd; margin: 20px 0; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
        button:hover { background: #0056b3; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ‡®ğŸ‡³ Hindi Language Dropdown Test</h1>
        <p>Testing the language dropdown functionality specifically for Hindi selection</p>
        
        <div class="test-section">
            <h3>Test Controls</h3>
            <button onclick="runLanguageTest()">ğŸ§ª Test Hindi Language Selection</button>
            <button onclick="checkDropdownElements()">ğŸ” Check Dropdown Elements</button>
            <button onclick="testClickEvents()">ğŸ‘† Test Click Events</button>
            <button onclick="clearResults()">ğŸ§¹ Clear Results</button>
        </div>
        
        <div id="results"></div>
        
        <iframe id="app-frame" src="http://localhost:8001"></iframe>
    </div>

    <script>
        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `${new Date().toLocaleTimeString()} - ${message}`;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        async function runLanguageTest() {
            addResult('ğŸš€ Starting Hindi Language Test...', 'info');
            
            const iframe = document.getElementById('app-frame');
            const frameWindow = iframe.contentWindow;
            const frameDoc = iframe.contentDocument;
            
            try {
                // Wait for app to load
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Check if language dropdown exists
                const languageDropdown = frameDoc.getElementById('language-options');
                if (languageDropdown) {
                    addResult('âœ… Language dropdown element found', 'success');
                } else {
                    addResult('âŒ Language dropdown element not found', 'error');
                    return;
                }
                
                // Check if selectLanguage function exists
                if (typeof frameWindow.selectLanguage === 'function') {
                    addResult('âœ… selectLanguage function exists', 'success');
                } else {
                    addResult('âŒ selectLanguage function not found', 'error');
                    return;
                }
                
                // Check if toggleLanguageDropdown function exists
                if (typeof frameWindow.toggleLanguageDropdown === 'function') {
                    addResult('âœ… toggleLanguageDropdown function exists', 'success');
                } else {
                    addResult('âŒ toggleLanguageDropdown function not found', 'error');
                }
                
                // Test clicking the language dropdown
                addResult('ğŸ”„ Testing language dropdown click...', 'info');
                const dropdownButton = frameDoc.querySelector('.language-dropdown');
                if (dropdownButton) {
                    addResult('âœ… Language dropdown button found', 'success');
                    
                    // Simulate click
                    dropdownButton.click();
                    
                    // Wait a moment
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    // Check if dropdown opened
                    const isOpen = languageDropdown.classList.contains('show');
                    if (isOpen) {
                        addResult('âœ… Language dropdown opened successfully', 'success');
                        
                        // Find Hindi option
                        const hindiOption = frameDoc.querySelector('.language-option[onclick*="hi"]');
                        if (hindiOption) {
                            addResult('âœ… Hindi language option found', 'success');
                            
                            // Test clicking Hindi option
                            addResult('ğŸ”„ Clicking Hindi option...', 'info');
                            hindiOption.click();
                            
                            // Wait for language change
                            await new Promise(resolve => setTimeout(resolve, 1000));
                            
                            // Check if language changed
                            const currentLang = frameDoc.getElementById('current-language');
                            if (currentLang && currentLang.textContent.includes('à¤¹à¤¿à¤‚à¤¦à¥€')) {
                                addResult('âœ… Language successfully changed to Hindi!', 'success');
                                
                                // Check if UI elements are translated
                                const heroTitle = frameDoc.querySelector('[data-translate="hero-title"]');
                                if (heroTitle && heroTitle.textContent.includes('à¤•à¥ƒà¤·à¤¿')) {
                                    addResult('âœ… UI elements are translated to Hindi', 'success');
                                } else {
                                    addResult('âš ï¸ UI elements may not be fully translated', 'warning');
                                }
                                
                            } else {
                                addResult('âŒ Language did not change to Hindi', 'error');
                                if (currentLang) {
                                    addResult(`Current language display: "${currentLang.textContent}"`, 'info');
                                }
                            }
                        } else {
                            addResult('âŒ Hindi language option not found', 'error');
                        }
                    } else {
                        addResult('âŒ Language dropdown did not open', 'error');
                    }
                } else {
                    addResult('âŒ Language dropdown button not found', 'error');
                }
                
            } catch (error) {
                addResult(`âŒ Test error: ${error.message}`, 'error');
            }
        }

        async function checkDropdownElements() {
            addResult('ğŸ” Checking dropdown elements...', 'info');
            
            const iframe = document.getElementById('app-frame');
            const frameDoc = iframe.contentDocument;
            
            try {
                // Check all language-related elements
                const elements = [
                    { selector: '.language-dropdown', name: 'Language Dropdown Button' },
                    { selector: '#language-options', name: 'Language Options Container' },
                    { selector: '#current-language', name: 'Current Language Display' },
                    { selector: '.language-option', name: 'Language Options', multiple: true }
                ];
                
                elements.forEach(element => {
                    const found = frameDoc.querySelector(element.selector);
                    if (found) {
                        if (element.multiple) {
                            const count = frameDoc.querySelectorAll(element.selector).length;
                            addResult(`âœ… ${element.name}: ${count} found`, 'success');
                        } else {
                            addResult(`âœ… ${element.name}: Found`, 'success');
                        }
                    } else {
                        addResult(`âŒ ${element.name}: Not found`, 'error');
                    }
                });
                
                // Check specific Hindi option
                const hindiOption = frameDoc.querySelector('.language-option[onclick*="hi"]');
                if (hindiOption) {
                    addResult(`âœ… Hindi option found: "${hindiOption.textContent.trim()}"`, 'success');
                } else {
                    addResult('âŒ Hindi option not found', 'error');
                }
                
            } catch (error) {
                addResult(`âŒ Element check error: ${error.message}`, 'error');
            }
        }

        async function testClickEvents() {
            addResult('ğŸ‘† Testing click events...', 'info');
            
            const iframe = document.getElementById('app-frame');
            const frameWindow = iframe.contentWindow;
            const frameDoc = iframe.contentDocument;
            
            try {
                // Test direct function call
                if (typeof frameWindow.selectLanguage === 'function') {
                    addResult('ğŸ”„ Testing direct selectLanguage function call...', 'info');
                    frameWindow.selectLanguage('hi', 'à¤¹à¤¿à¤‚à¤¦à¥€', 'ğŸ‡®ğŸ‡³');
                    
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const currentLang = frameDoc.getElementById('current-language');
                    if (currentLang && currentLang.textContent.includes('à¤¹à¤¿à¤‚à¤¦à¥€')) {
                        addResult('âœ… Direct function call worked!', 'success');
                    } else {
                        addResult('âŒ Direct function call failed', 'error');
                    }
                } else {
                    addResult('âŒ selectLanguage function not available', 'error');
                }
                
                // Test dropdown toggle
                if (typeof frameWindow.toggleLanguageDropdown === 'function') {
                    addResult('ğŸ”„ Testing toggleLanguageDropdown function...', 'info');
                    frameWindow.toggleLanguageDropdown();
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    const dropdown = frameDoc.getElementById('language-options');
                    if (dropdown && dropdown.classList.contains('show')) {
                        addResult('âœ… Dropdown toggle worked!', 'success');
                    } else {
                        addResult('âŒ Dropdown toggle failed', 'error');
                    }
                }
                
            } catch (error) {
                addResult(`âŒ Click event test error: ${error.message}`, 'error');
            }
        }

        // Auto-run test when page loads
        window.onload = function() {
            setTimeout(() => {
                addResult('ğŸŒŸ Hindi Language Dropdown Test Ready', 'info');
                addResult('Click "Test Hindi Language Selection" to start testing', 'info');
            }, 1000);
        };
    </script>
</body>
</html>